const bestWPM = document.querySelector("#best-wpm");
const wpm = document.querySelector("#wpm");
const accuracy = document.querySelector("#accuracy");
const time = document.querySelector("#time");
const difficultyBtn = document.querySelector("#difficulty-btn");
const difficultyDD = document.querySelector("#difficulty-dd");
const modeBtn = document.querySelector("#mode-btn");
const modeDD = document.querySelector("#mode-dd");
const difficultyDeskNav = document.querySelector("#difficulty-desk-nav");
const modeDeskNav = document.querySelector("#mode-desk-nav");

const difficultyBtns = document.getElementsByName("difficulty");
const modeBtns = document.getElementsByName("mode");
const inputField = document.querySelector("#input-field");

const data = {
  bestWPM: 0,
  difficulty: null,
  mode: null,
};

class UI {
  getStarted(element) {
    const inputField = document.querySelector("#input-field");
    element.remove();
    inputField.classList.remove("blur-sm");
  }

  toggleDropDown(button) {
    button.querySelector("img").classList.toggle("-rotate-90");
    const difficultyDD = button.closest('div').querySelector('.drop-down')
    difficultyDD.classList.toggle('hidden')

  }

  desktopNav(button) {
    
  }
}


// Difficulty dropDown
difficultyBtn.addEventListener("click", (e) => {
  const ui = new UI()
  ui.toggleDropDown(e.target)

});

// Difficulty Desktop Nav
difficultyDeskNav.addEventListener("click", (e) => {
  const btns = difficultyDeskNav.querySelectorAll("button");
  btns.forEach((btn) => {
    btn.classList.remove("text-gray-50", "border-gray-50");
    btn.classList.add("text-blue-400", "border-blue-400");
  });

  if (e.target.closest("button")) {
    e.target.classList.remove("text-blue-400", "border-blue-400");
    e.target.classList.add("text-gray-50", "border-gray-50");
  }
});

// Mode Desktop Nav
modeDeskNav.addEventListener("click", (e) => {
  const btns = modeDeskNav.querySelectorAll("button");
  btns.forEach((btn) => {
    btn.classList.remove("text-gray-50", "border-gray-50");
    btn.classList.add("text-blue-400", "border-blue-400");
  });

  if (e.target.closest("button")) {
    e.target.classList.remove("text-blue-400", "border-blue-400");
    e.target.classList.add("text-gray-50", "border-gray-50");
  }
});

// Mode dropDown
modeBtn.addEventListener("click", (e) => {
  const ui = new UI();
  ui.toggleDropDown(e.target);
});


function selectedBtn(btns) {
  let selected = null;
  for (let btn of btns) {
    if (btn.checked) {
      selected = btn;
      break;
    }
  }

  return selected.value;
}

const text = `The archaeological expedition unearthed artifacts that complicated prevailing theories about Bronze Age trade networks. Obsidian from Anatolia, lapis lazuli from Afghanistan, and amber from the Baltic-all discovered in a single Mycenaean tomb-suggested commercial connections far more extensive than previously hypothesized. "We've underestimated ancient peoples' navigational capabilities and their appetite for luxury goods, "the lead researcher observed. "Globalization isn't as modern as we assume.`;
const arr = text.split("");
arr.forEach((letter) => {
  const char = document.createElement("span");
  char.classList.add("text-neutral-400");
  char.innerText = letter;
  inputField.appendChild(char);
});

// Event Listeners

// start Btn
document.querySelector("#start-btn").addEventListener("click", (e) => {
  const ui = new UI();

  if (e.target.parentElement.classList.contains("blur-overlay")) {
    ui.getStarted(e.target.parentElement);
  }
});


  // Hide DropDowns when looses focus
  document.addEventListener("click", (e) => {
    if (!difficultyBtn.contains(e.target)) {
      if (difficultyDD.contains(e.target)) {
        setTimeout(() => {
          difficultyBtn.querySelector("img").classList.add("-rotate-90");
          difficultyDD.classList.add("hidden");
        }, 400);
  
        difficultyBtn.innerHTML = `
              ${selectedBtn(difficultyBtns)}
              <img src="./assets/images/icon-down-arrow.svg" class="transition-all" alt="">
              `;
      } else {
        difficultyBtn.querySelector("img").classList.add("-rotate-90");
        difficultyDD.classList.add("hidden");
      }
    }
  
    if (!modeBtn.contains(e.target)) {
      if (modeDD.contains(e.target)) {
        setTimeout(() => {
          modeBtn.querySelector("img").classList.add("-rotate-90");
          modeDD.classList.add("hidden");
        }, 400);
  
        modeBtn.innerHTML = `
              ${selectedBtn(modeBtns)}
              <img src="./assets/images/icon-down-arrow.svg" class="transition-all" alt="">
              `;
      } else {
        modeBtn.querySelector("img").classList.add("-rotate-90");
        modeDD.classList.add("hidden");
      }
    }
  });